# 汽車維修測驗系統

專為汽車維修技術人員設計的互動式測驗應用程式，採用 TypeScript 開發，包含完整的汽車維修知識題庫和智能進度管理系統。

## 核心特色

### 🎯 智能測驗系統
- **完整題庫**：317題汽車維修專業題目（選擇題143題，是非題174題）
- **雙階段選單**：題型選擇 → 範圍選擇的直覺式介面
- **智能過濾**：自動排除已答對和標記題目，專注未掌握內容
- **即時統計**：顯示可用題數、已答對、待重做、已標記等詳細進度
- **Fisher-Yates 隨機演算法**：確保題目順序公平隨機

### 📚 進度追蹤系統
- **三分類管理**：
  - `已答對` - 排除於後續測驗，避免重複
  - `答錯待重做` - 優先出題，強化薄弱環節  
  - `永久標記` - 使用 `-` 指令永久排除
- **即時保存**：每次互動後立即寫入 `quiz-data.json`，防止進度丟失
- **自動復原**：程式重啟後自動載入上次進度

### 🔄 彈性答題模式
**選擇題**：
- 直接輸入選項編號 `1`、`2`、`3`
- 立即答案驗證和正確率計算

**是非題**：
- 支援數字輸入：`1`（正確/O）、`2`（錯誤/X）
- 支援字母輸入：`O`/`o`（正確）、`X`/`x`（錯誤）
- **智能說明系統**：僅對答案為「X」（錯誤）的題目顯示詳細說明

### 📌 進階控制指令
**測驗中可用指令**：
- **`-`**：標記此題永不再出現，同時顯示正確答案
- **`?`**：顯示答案並加入錯題庫供日後重做
- **`q`**：結束本輪測驗，顯示詳細成績統計

**重置選項**：
- **`r`**：重置答題記錄（保留永久標記）
- **`R`**：完全重置（清除所有記錄包含標記）

## 快速開始

### 安裝與建置
```bash
# 安裝相依套件
npm install

# 建置程式（生產版本，僅包含主程式）
npm run build
```

### 執行測驗
```bash
# 開始測驗
npm start

# 開發模式（建置 + 執行）
npm run dev
```

### 測驗流程示例

**第一步：選擇題型**
```
=== 測驗進度 ===
可用題數：316
已標記永不出現：20
已答對：110  
答錯待重做：5
尚未作答：181

=== 第一步：選擇題型 ===
1. 是非題 (95 題)
2. 選擇題 (91 題)
3. 混合題型 (186 題)
r. reset 重新開始 (清除答對/答錯記錄，保留標記)
R. reset-all 完全重置 (清除所有記錄包含標記)  
q. 離開
請選擇題型：
```

**第二步：選擇範圍**
```
=== 第二步：選擇範圍 ===
1. 只測驗答錯的題目 (5 題)
2. 測驗所有可用題目 (186 題)
b. 返回題型選擇
請選擇測驗範圍：
```

**答題範例**
```
題目 15: 柴油引擎，是用火星塞點火的。
  請選擇：
  (1) 正確 (O)
  (2) 錯誤 (X)
  或直接回答 O/o (正確) 或 X/x (錯誤)
  或輸入：
    - : 標記此題永不再出現
    ? : 不知道答案，顯示答案後加入錯題
    q : 返回主選單（顯示本輪成績）
您的答案：2
✔ 答對了！
說明：柴油引擎靠壓縮空氣產生高溫使燃料著火燃燒
```

## 技術架構

### 主要技術
- **語言**：TypeScript
- **執行環境**：Node.js
- **使用者介面**：Console (readline-sync)
- **資料處理**：PDF解析 + CSV處理 + JSON生成

### 專案結構
```
├── src/
│   ├── quiz.ts                    # 主程式（測驗邏輯和使用者介面）
│   ├── types/index.ts             # TypeScript 型別定義
│   ├── data/
│   │   ├── questions.json         # 完整題庫（317題）
│   │   └── quiz-data.json         # 使用者進度記錄
│   └── tools/                     # 資料處理工具
│       ├── pdf-to-csv.ts          # PDF 轉 CSV 工具
│       ├── csv-to-json.ts         # CSV 合併轉 JSON 工具
│       ├── verify-explanations.ts # 說明驗證工具
│       └── src_data/              # 原始資料檔案
└── dist/                          # 編譯輸出目錄
    ├── quiz.js                    # 主程式
    ├── types/                     # 型別檔案
    ├── data/                      # 資料檔案
    └── tools/                     # 工具程式（僅開發版本）
```

### 建置系統
**雙重建置策略**：
- **生產建置** (`npm run build`)：僅編譯主程式，輕量化部署
- **開發建置** (`npx tsc`)：包含所有工具，支援資料處理

## 資料處理流程

### 完整的資料處理管道
如需重新處理題庫資料，請依序執行：

```bash
# 1. 編譯 TypeScript
npx tsc

# 2. 處理是非題 PDF
node dist/tools/pdf-to-csv.js

# 3. 處理選擇題 PDF  
node dist/tools/pdf-to-csv-multiple-choice.js

# 4. 合併 CSV 並生成最終 JSON（含說明匹配）
node dist/tools/csv-to-json.js
```

### 智能說明匹配
- **自動匹配演算法**：使用模糊比對為64題答案為「X」的是非題添加詳細說明
- **相似度門檻**：80%文字相似度確保準確匹配
- **完整覆蓋**：所有錯誤觀念題目都配有正確概念澄清

## 開發工具

### 資料驗證工具
```bash
# 驗證說明完整性
npx tsc && node dist/tools/verify-explanations.js

# 偵錯說明匹配
npx tsc && node dist/tools/debug-matching.js

# 手動新增說明
npx tsc && node dist/tools/add-explanations.js
```

### TypeScript 設定
- **開發設定** (`tsconfig.json`)：完整編譯，包含所有工具
- **生產設定** (`tsconfig.prod.json`)：選擇性編譯，僅主程式和型別

## 特殊功能

### 資料完整性保護
- **爭議題目過濾**：自動排除題目 ID '034'（大型車空檔滑行議題）
- **進度自動復原**：程式重啟後自動載入先前進度
- **原子性操作**：每次使用者互動都觸發完整狀態保存

### 演算法亮點
- **Fisher-Yates 洗牌演算法**：確保題目隨機順序無偏差
- **模糊字串匹配**：80%相似度門檻的智能說明配對
- **三分類狀態管理**：sophisticated progression tracking between answered/failed/marked categories

## 系統需求

- Node.js (建議版本 16+)
- TypeScript 5.9+
- 相依套件：readline-sync, pdf-parse

---

**開始挑戰汽車維修專業知識！** 🚗⚡